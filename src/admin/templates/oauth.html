{% extends "base.html" %}

{% block title %}OAuth 授权{% endblock %}

{% block content %}
<div class="header">
    <h1>Antigravity API 管理面板</h1>
    <a href="/admin/">返回</a>
</div>

<div class="container">
    <div class="card" style="max-width: 720px; margin: 0 auto;">
        <h3 style="margin-bottom: 12px;">OAuth 授权登录</h3>
        <p style="color: #6c757d; margin-bottom: 20px;">按步骤完成授权后，将回调地址栏完整 URL 粘贴回来提交。</p>

        <div style="border: 1px solid #e9ecef; border-radius: 6px; padding: 16px; margin-bottom: 20px; background: #f8f9fa;">
            <h4 style="margin-bottom: 8px; color: #1a1a2e;">授权流程：</h4>
            <ol style="color: #6c757d; margin-left: 16px; line-height: 1.6;">
                <li>点击下方按钮打开 Google 授权页面</li>
                <li>完成授权后，复制浏览器地址栏的完整 URL</li>
                <li>粘贴 URL 到下方输入框并提交</li>
            </ol>
            <p style="color: #6c757d; margin-top: 8px; font-size: 13px;">提示：state 仅 15 分钟有效，过期请重新开始。</p>
        </div>

        <div style="text-align: center; margin-bottom: 20px;">
            <a href="{{ auth_url }}" target="_blank" rel="noopener noreferrer" class="btn btn-primary" style="padding: 12px 32px; font-size: 16px;">
                打开授权页面
            </a>
        </div>

        <form method="post" action="/admin/oauth/manual/complete" style="text-align: left;">
            <label for="callback_url" style="display: block; margin-bottom: 8px; color: #333; font-weight: 600;">粘贴完整的回调 URL</label>
            <input
                id="callback_url"
                name="callback_url"
                type="url"
                required
                placeholder="http://localhost:xxxx/oauth-callback?code=...&state=..."
                style="width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; margin-bottom: 16px; font-size: 14px;"
            >
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <a href="/admin/" class="btn" style="background: #e9ecef; color: #495057;">取消</a>
                <button type="submit" class="btn btn-success" style="padding: 10px 24px; font-size: 15px;">提交</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
